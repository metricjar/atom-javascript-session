!function(s,e,t){"use strict";function i(e){this.TAG="ISA-Session";var t="1.1.7",i="atom-js-session";if(this.STORAGE_PREFIX="ATOM_SESSION_",this.SESSION_KEY="SESSION_ID",this.SESSION_LAST_ACTIVE="SESSION_LAST_ACTIVE",this.USER_ID="USER_ID",e=e||{},this.userID=e.userID,this.sessionID=e.sessionID,this.sessionLastActive=e.sessionLastActive||Date.now(),this.isDebug=e.debug||!1,!s.IronSourceAtom)throw new Error("Please include the ironSource Atom SDK in order to use the session sdk");e.sdkVersion=t,e.sdkType=i,this.tracker_=new IronSourceAtom.Tracker(e),this.sessionLifeTime=e.sessionLifeTime?e.sessionLifeTime:18e5,this.userID&&(S(this.TAG,"UserID added: "+this.userID,this.isDebug),localStorage.setItem(this.STORAGE_PREFIX+this.USER_ID,this.userID)),this.sessionID&&(S(this.TAG,"Session added: "+this.sessionID,this.isDebug),S(this.TAG,"Session Last Active: "+this.sessionLastActive,this.isDebug),localStorage.setItem(this.STORAGE_PREFIX+this.SESSION_KEY,this.sessionID),localStorage.setItem(this.STORAGE_PREFIX+this.SESSION_LAST_ACTIVE,this.sessionLastActive))}function o(s){for(var e=s?s:32,t="",i=0;i<e;i++)switch(i){case 8:case 20:t+=(16*Math.random()|0).toString(16);break;case 16:t+=(4*Math.random()|8).toString(16);break;default:t+=(16*Math.random()|0).toString(16)}return t}function S(s,e,t){t&&console.log(s+": "+e)}s.IronSourceAtomSession=i,i.prototype.track=function(s,e){function t(){var s=localStorage.getItem(r.STORAGE_PREFIX+r.SESSION_KEY),e=localStorage.getItem(r.STORAGE_PREFIX+r.SESSION_LAST_ACTIVE),t=Date.now();return S(r.TAG,"SessionID: "+s,r.isDebug),S(r.TAG,"SessionLastActive: "+e,r.isDebug),S(r.TAG,"SessionLifeTime:"+r.sessionLifeTime,r.isDebug),!s||t-e>=r.sessionLifeTime?(s=o(),localStorage.setItem(r.STORAGE_PREFIX+r.SESSION_KEY,s),localStorage.setItem(r.STORAGE_PREFIX+r.SESSION_LAST_ACTIVE,t),S(r.TAG,"Session ID updated: "+s,r.isDebug),s):(localStorage.setItem(r.STORAGE_PREFIX+r.SESSION_LAST_ACTIVE,t),s)}function i(){var s=localStorage.getItem(r.STORAGE_PREFIX+r.USER_ID);return s||(s=o(),localStorage.setItem(r.STORAGE_PREFIX+r.USER_ID,s)),S(r.TAG,"UserID: "+s,r.isDebug),s}var r=this,n={};if("string"==typeof e||e instanceof String)try{n=JSON.parse(e)}catch(s){throw new Error("Invalid JSON String - can't be converted to Object, "+s)}else n=e;n.ib_sessionid=t(),n.ib_userid=i(),r.tracker_.track(s,n)},i.prototype.flush=function(s,e){this.tracker_.flush(s,e)},"undefined"!=typeof module&&module.exports&&(module.exports={Session:i})}(window,document);